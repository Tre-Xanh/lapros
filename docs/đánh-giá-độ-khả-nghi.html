<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Đánh giá độ khả nghi | LaPros</title>
  <meta name="description" content="Đánh giá độ khả nghi | LaPros" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Đánh giá độ khả nghi | LaPros" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Đánh giá độ khả nghi | LaPros" />
  
  
  

<meta name="author" content="Chi Cong Vo" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="cuối-cùng.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>




</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Mở đầu</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#lỗi-quan-sát-nhãn-là-gì"><i class="fa fa-check"></i>Lỗi quan sát nhãn là gì?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#quy-trình-nhiễu-theo-lớp"><i class="fa fa-check"></i>Quy trình nhiễu theo lớp</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#ví-dụ-cụ-thể"><i class="fa fa-check"></i>Ví dụ cụ thể</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#ma-trận-nhiễu-theo-lớp"><i class="fa fa-check"></i>Ma trận nhiễu theo lớp</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="đánh-giá-độ-khả-nghi.html"><a href="đánh-giá-độ-khả-nghi.html"><i class="fa fa-check"></i>Đánh giá độ khả nghi</a>
<ul>
<li class="chapter" data-level="" data-path="đánh-giá-độ-khả-nghi.html"><a href="đánh-giá-độ-khả-nghi.html#khái-quát"><i class="fa fa-check"></i>Khái quát</a></li>
<li class="chapter" data-level="" data-path="đánh-giá-độ-khả-nghi.html"><a href="đánh-giá-độ-khả-nghi.html#chỉ-tiêu-tự-tin"><i class="fa fa-check"></i>Chỉ tiêu tự tin</a></li>
<li class="chapter" data-level="" data-path="đánh-giá-độ-khả-nghi.html"><a href="đánh-giá-độ-khả-nghi.html#xếp-hạng-khả-nghi"><i class="fa fa-check"></i>Xếp hạng khả nghi</a></li>
<li class="chapter" data-level="" data-path="đánh-giá-độ-khả-nghi.html"><a href="đánh-giá-độ-khả-nghi.html#ước-lượng-ma-trận-nhiễu"><i class="fa fa-check"></i>Ước lượng ma trận nhiễu</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cuối-cùng.html"><a href="cuối-cùng.html"><i class="fa fa-check"></i>Cuối cùng</a>
<ul>
<li class="chapter" data-level="" data-path="cuối-cùng.html"><a href="cuối-cùng.html#triển-vọng"><i class="fa fa-check"></i>Triển vọng</a></li>
<li class="chapter" data-level="" data-path="cuối-cùng.html"><a href="cuối-cùng.html#tham-khảo"><i class="fa fa-check"></i>Tham khảo</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">LaPros</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="đánh-giá-độ-khả-nghi" class="section level1 hasAnchor">
<h1>Đánh giá độ khả nghi<a href="đánh-giá-độ-khả-nghi.html#đánh-giá-độ-khả-nghi" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="khái-quát" class="section level2 hasAnchor">
<h2>Khái quát<a href="đánh-giá-độ-khả-nghi.html#khái-quát" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Đầu vào</strong></p>
<ol style="list-style-type: decimal">
<li>Các nhãn <span class="math inline">\(\tilde{y}_k\)</span> đã quan sát được đối với các mẫu <span class="math inline">\({\boldsymbol{{x}}}_k\in{\boldsymbol{{X}}}\)</span></li>
<li>Xác suất <span class="math inline">\(p_{\tilde{y}={i}}({{\boldsymbol{{x}}}_k})\)</span> mà mô hình <span class="math inline">\({{\boldsymbol{{\phi}}}}\)</span> dự đoán mẫu <span class="math inline">\({\boldsymbol{{x}}}_k\in{\boldsymbol{{X}}}\)</span> có nhãn <span class="math inline">\(i\in M\)</span></li>
</ol>
<p>Mặc nhiên</p>
<p><span class="math display" id="eq:probasum1">\[\begin{equation}
\begin{cases}
p_{\tilde{y}={i}}({{\boldsymbol{{x}}}}) \geq 0 &amp; \quad\forall i\in M, \forall{\boldsymbol{{x}}}\in{\boldsymbol{{X}}}\\
\sum\limits_{i\in M}{p_{\tilde{y}={i}}({{\boldsymbol{{x}}}})} \equiv 1 &amp; \quad\forall {\boldsymbol{{x}}}\in{\boldsymbol{{X}}}
\end{cases}
\tag{1}
\end{equation}\]</span></p>
<p><strong>Các bước</strong></p>
<ol style="list-style-type: decimal">
<li>Tính <span class="math inline">\(t_i\)</span>, độ tự tin trung bình theo <span class="math inline">\({{\boldsymbol{{\phi}}}}\)</span> trong từng lớp <span class="math inline">\(i\in M\)</span></li>
<li>Ước lượng phân bố xác suất đồng thời <span class="math inline">\(\dot{{\boldsymbol{{Q}}}}_{\tilde{y}, \dot{y}}\)</span> cho nhãn quan sát và nhãn thật</li>
<li><em>Lọc và xếp hạng các mẫu theo mức độ khả nghi nhãn bị lỗi</em></li>
<li>Loại bỏ các mẫu khả nghi nhất là nhãn bị lỗi</li>
<li>Đặt trọng số cho các mẫu trong từng lớp <span class="math inline">\(i\in M\)</span> để học một mô hình mới.</li>
</ol>
</div>
<div id="chỉ-tiêu-tự-tin" class="section level2 hasAnchor">
<h2>Chỉ tiêu tự tin<a href="đánh-giá-độ-khả-nghi.html#chỉ-tiêu-tự-tin" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Gọi số lượng mẫu được quan sát có nhãn <span class="math inline">\(\tilde{y}=i\)</span> là
<span class="math inline">\({\boldsymbol{{C}}}_{\tilde{y}=i} ≔|{\boldsymbol{{X}}}_{\tilde{y}=i}|.\)</span></p>
<p>Độ tự tin trung bình của mô hình <span class="math inline">\({{\boldsymbol{{\phi}}}}\)</span> đối với lớp <span class="math inline">\(i\in M\)</span> là</p>
<p><span class="math display" id="eq:avgconfidence">\[\begin{equation}
  {\boldsymbol{{t}}}_i = \frac{1}{{\boldsymbol{{C}}}_{\tilde{y}=i}}
  {\sum\limits_{{\boldsymbol{{x}}}\in{\boldsymbol{{X}}}_{\tilde{y}=i}}p_{\tilde{y}={i}}({{\boldsymbol{{x}}}})}.
\tag{2}
\end{equation}\]</span></p>
<p>Vì phép tính trung bình được thực hiện trên từng tập
<span class="math inline">\({\boldsymbol{{X}}}_{\tilde{y}=i}\)</span>
nên có thể <span class="math inline">\(\sum\limits_{i\in M}{{\boldsymbol{{t}}}_i} \neq 1.\)</span>
Ta đề xuất lấy trung bình trên toàn bộ tập <span class="math inline">\({\boldsymbol{{X}}}\)</span>
nếu <span class="math inline">\({\boldsymbol{{X}}}_{\tilde{y}=i}\equiv\emptyset.\)</span></p>
<p>Với mỗi lớp <span class="math inline">\(i\in M\)</span> ta chọn chỉ tiêu tự tin <span class="math inline">\({\boldsymbol{{t}}}_i\in(0,1)\)</span>
bằng độ tự tin trung bình <a href="đánh-giá-độ-khả-nghi.html#eq:avgconfidence">(2)</a>.
Đối với từng mẫu <span class="math inline">\({\boldsymbol{{x}}}\)</span> và từng nhãn <span class="math inline">\(i\)</span>, giá trị xác suất dự đoán
<span class="math inline">\(p_{\tilde{y}={i}}({{\boldsymbol{{x}}}})\)</span> đưa ra bởi mô hình <span class="math inline">\({{\boldsymbol{{\phi}}}}\)</span>,
nếu không nhỏ hơn chỉ tiêu <span class="math inline">\({\boldsymbol{{t}}}_i\)</span> thì ta cho rằng nhãn <span class="math inline">\(i\)</span> có khả năng đúng với mẫu <span class="math inline">\({\boldsymbol{{x}}}\)</span>.
Tập hợp nhãn khả dĩ đối với mẫu <span class="math inline">\({\boldsymbol{{x}}}\)</span> là</p>
<p><span class="math display" id="eq:eq2">\[\begin{equation}
L_{{{\boldsymbol{{\phi}}}},{\boldsymbol{{t}}}}({\boldsymbol{{x}}})≔\left\{i\in M: p_{\tilde{y}={i}}({{\boldsymbol{{x}}}})\geq {\boldsymbol{{t}}}_i\right\}
\tag{3}
\end{equation}\]</span></p>
<p>Với giả định xác suất <a href="đánh-giá-độ-khả-nghi.html#eq:probasum1">(1)</a>
và chỉ tiêu tự tin <a href="đánh-giá-độ-khả-nghi.html#eq:avgconfidence">(2)</a>,
với kỳ vọng <span class="math inline">\(L_{{{\boldsymbol{{\phi}}}},{\boldsymbol{{t}}}}({\boldsymbol{{x}}})\neq\emptyset,\)</span>
CleanLab (Curtis et al.’s 2021)
chọn một nhãn có xác suất dự đoán lớn nhất:
<span class="math display" id="eq:lmtxcleanlab">\[\begin{equation}
\hat{l}_{{{\boldsymbol{{\phi}}}},{\boldsymbol{{t}}}}({\boldsymbol{{x}}})≔
\mathop{\rm arg max}\limits_{i\in L_{{{\boldsymbol{{\phi}}}},{\boldsymbol{{t}}}}({\boldsymbol{{x}}})}p_{\tilde{y}={i}}({{\boldsymbol{{x}}}})
\tag{4}
\end{equation}\]</span></p>
<p>để làm nhãn “đáng tin nhất” cho mẫu <span class="math inline">\({\boldsymbol{{x}}}.\)</span></p>
<p>Ta đề xuất
bù trừ chỉ tiêu vào công thức trên để cân đối với độ tự tin của mô hình,
đồng thời
nới lỏng ràng buộc <span class="math inline">\(i\in L_{{{\boldsymbol{{\phi}}}},{\boldsymbol{{t}}}}({\boldsymbol{{x}}})\)</span> để tránh trường hợp không chọn được nhãn đáng tin,
<span class="math display" id="eq:lmtx">\[\begin{equation}
\hat{l}_{{{\boldsymbol{{\phi}}}},{\boldsymbol{{t}}}}({\boldsymbol{{x}}})≔
\mathop{\rm arg max}\limits_{i\in M}\{p_{\tilde{y}={i}}({{\boldsymbol{{x}}}}) - {\boldsymbol{{t}}}_i\}.
\tag{5}
\end{equation}\]</span></p>
</div>
<div id="xếp-hạng-khả-nghi" class="section level2 hasAnchor">
<h2>Xếp hạng khả nghi<a href="đánh-giá-độ-khả-nghi.html#xếp-hạng-khả-nghi" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Gọi <span class="math inline">\(\dot{{\boldsymbol{{X}}}}_{\tilde{y}=i,\dot{y}=j}\)</span> là tập (bất khả tri) các mẫu có nhãn quan sát là <span class="math inline">\(i\)</span> và nhãn thật là <span class="math inline">\(j\)</span>, ta ước lượng nó bằng cách dùng các nhãn đáng tin nhất <span class="math inline">\(\hat{l}_{{{\boldsymbol{{\phi}}}},{\boldsymbol{{t}}}}({\boldsymbol{{x}}})\)</span> tại <a href="đánh-giá-độ-khả-nghi.html#eq:lmtx">(5)</a>:</p>
<p><span class="math display" id="eq:eq3b">\[\begin{equation}
{{\boldsymbol{{X}}}}_{\tilde{y}=i,\dot{y}=j} ≔
\left\{{\boldsymbol{{x}}}\in{\boldsymbol{{X}}}_{\tilde{y}=i}:
\hat{l}_{{{\boldsymbol{{\phi}}}}({\boldsymbol{{x}}}),{\boldsymbol{{t}}}} \equiv j
\right\}
\tag{6}
\end{equation}\]</span></p>
<p>Đơn thuần (mà lại hiệu quả) nhất, ta nghi ngờ
các mẫu <span class="math inline">\(\left\{{\boldsymbol{{x}}}\in{{\boldsymbol{{X}}}}_{\tilde{y}=i,\dot{y}=j}: i\neq j\right\}\)</span>
nằm ngoài đường chéo của ma trận
<span class="math inline">\({{\boldsymbol{{X}}}}_{\tilde{y},\dot{y}}\)</span>
là có nhãn lỗi.
Xếp hạng mức độ khả nghi của các mẫu đó
dựa theo xác suất do mô hình <span class="math inline">\({{\boldsymbol{{\phi}}}}\)</span> dự đoán:
<span class="math display" id="eq:errnoise">\[\begin{equation}
{e}({{\boldsymbol{{x}}}}) ≔\max_{j\neq i}{p_{\tilde{y}={j}}({{\boldsymbol{{x}}}})}
-p_{\tilde{y}={i}}({{\boldsymbol{{x}}}})\quad \forall {\boldsymbol{{x}}}\in{\boldsymbol{{X}}}_{\tilde{y}=i}
\tag{7}
\end{equation}\]</span>
theo cách làm trong CleanLab của Curtis et al.’s (2021), và đảo dấu so với Wei et al.’s (2018).</p>
<p>Chúng tôi đề xuất bù trừ chỉ tiêu tự tin vào để tính độ khả nghi:
<span class="math display" id="eq:eq4">\[\begin{equation}
e_{\boldsymbol{{t}}}({\boldsymbol{{x}}}) ≔
\max_{j\neq i}{\{p_{\tilde{y}={j}}({{\boldsymbol{{x}}}})-{\boldsymbol{{t}}}_j\}}
-\{p_{\tilde{y}={i}}({{\boldsymbol{{x}}}}) - {\boldsymbol{{t}}}_i\}
\quad \forall {\boldsymbol{{x}}}\in{\boldsymbol{{X}}}_{\tilde{y}=i};
\tag{8}
\end{equation}\]</span>
bảo đảm
<span class="math inline">\(e_{\boldsymbol{{t}}}({\boldsymbol{{x}}})\in[0,1].\)</span></p>
</div>
<div id="ước-lượng-ma-trận-nhiễu" class="section level2 hasAnchor">
<h2>Ước lượng ma trận nhiễu<a href="đánh-giá-độ-khả-nghi.html#ước-lượng-ma-trận-nhiễu" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Ma trận đếm cặp nhãn <span class="math inline">\({{\boldsymbol{{C}}}}_{\tilde{y},\dot{y}}\)</span> kích thước <span class="math inline">\(m\times m\)</span>
lưu số phần tử của các tập <span class="math inline">\({{\boldsymbol{{X}}}}_{\tilde{y}=i,\dot{y}=j}\)</span>,</p>
<p><span class="math display" id="eq:eq5">\[\begin{equation}
{{\boldsymbol{{C}}}}_{\tilde{y}=i,\dot{y}=j} ≔|{{\boldsymbol{{X}}}}_{\tilde{y}=i,\dot{y}=j} |
\tag{9}
\end{equation}\]</span></p>
<p>ví dụ <span class="math inline">\({{\boldsymbol{{C}}}}_{\tilde{y}=3,\dot{y}=1} = 10\)</span> có nghĩa là, đếm được
10 mẫu được gán nhãn <span class="math inline">\(3\)</span> nhưng “thật ra” nên có nhãn <span class="math inline">\(1.\)</span></p>
<p>Vì <a href="đánh-giá-độ-khả-nghi.html#eq:eq3b">(6)</a> ước lượng
<span class="math inline">\({{\boldsymbol{{X}}}}_{\tilde{y}=i,\dot{y}=j}\approx\dot{{\boldsymbol{{X}}}}_{\tilde{y}=i,\dot{y}=j}\)</span> cho nên
<span class="math inline">\(\sum\limits_{j\in M}{{\boldsymbol{{C}}}}_{\tilde{y}=i,\dot{y}=j} \approx {\boldsymbol{{C}}}_{\tilde{y}=i}.\)</span></p>
<p>Hiệu chỉnh ma trận đếm cặp nhãn qua hai bước.
Bước đầu, hiệu chỉnh từng dòng theo số mẫu của từng lớp đã quan sát <span class="math inline">\(i\in M,\)</span></p>
<p><span class="math display" id="eq:eq6a">\[\begin{equation}
\check{Q}_{\tilde{y}=i,\dot{y}=j} = \frac{{{\boldsymbol{{C}}}}_{\tilde{y}=i,\dot{y}=j}}{\sum\limits_{j\in M}{{\boldsymbol{{C}}}}_{\tilde{y}=i,\dot{y}=j}}
{{\boldsymbol{{C}}}_{\tilde{y}=i}}.
\tag{10}
\end{equation}\]</span></p>
<p>Cuối cùng, ta chia đều toàn bộ để tổng ma trận trở thành <span class="math inline">\(1.\)</span></p>
<p><span class="math display" id="eq:eq6b">\[\begin{equation}
{\boldsymbol{{Q}}}_{\tilde{y}=i,\dot{y}=j}=\frac{\check{Q}_{\tilde{y}=i,\dot{y}=j}}{\sum\limits_{i,j\in M}\check{Q}_{\tilde{y}=i,\dot{y}=j}}.
\tag{11}
\end{equation}\]</span></p>
<p>Curtis et al.’s (2021) trình bày một số
phương pháp dùng ma trận nhiễu <a href="đánh-giá-độ-khả-nghi.html#eq:eq6b">(11)</a>
để chọn lọc và xếp hạng nhãn khả nghi có lỗi.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="cuối-cùng.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
